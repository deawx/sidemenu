!function(t,e){if("function"==typeof define&&define.amd)define(["jquery"],function(s){var i=e(s);return s.extend(t,i),i});else if("object"==typeof module&&module.exports){var s=require("jquery"),i=e(s);s.extend(t,i),module.exports=i}else t.jQuery.extend(t,e(t.jQuery))}(this,function(t){function e(e,s){this.options={},t.extend(this.options,s),this.$el=t("<div/>").addClass("sm sm-added"),this.$body=t("<div/>").addClass("sm-body").appendTo(this.$el),this.$scroller=t("<div/>").addClass("sm-scroller").appendTo(this.$body),this.$content=t("<div/>").addClass("sm-content").appendTo(this.$scroller),this.el=this.$el.get(0),this.$scroller.on("scroll",function(t){this.scrollHeight-this.scrollTop===this.clientHeight?(t.preventDefault(),this.scrollTop=this.scrollTop-1):0===this.scrollTop&&(this.scrollTop=1)}),this.options.title&&this.$content.append(t("<div/>").addClass("sm-title").text(this.title=this.options.title)),this.$list=t("<ul/>").appendTo(this.$content).get(0),this.items=[],this.addItems(e),this.isOpen=!1,this.parentItem=null}function s(t,s){s=s||{},s.back="",e.call(this,t,s),this.history={stacks:[],clear:function(){this.stacks=[]},add:function(t){t&&this.stacks.push(t)},pop:function(){return this.stacks.pop()},beforeLastStak:function(){return this.stacks[this.stacks.length-2]},isEmpty:function(){return 0===this.stacks.length}},this._target=null,this.sideMenu=this,this.currentMenu=null}function i(){this.$el=t("<li/>").addClass("sm-item"),this.el=this.$el.get(0),this.parent=null}function n(e,s){if(void 0===e)throw"Error in SMLabelItem: title param is undefined";i.call(this),this.title=e,this.dom=this.dom||{},this.dom.title=t("<span/>").addClass("sm-label-text").text(this.title),this.$el.append(this._label=t("<div/>").addClass("sm-item-label").addClass(s).append(t("<span/>").addClass("sm-label-icon")).append(this.dom.title))}function o(t,e,s){var i=this;n.call(this,t,s),this.$el.addClass("sm-item-more"),this._label.on(f,function(t){t.stopPropagation(),i.subMenu.open()}),this.subMenu=new b(e,{title:t}),this.subMenu._setParent(this),this.$el.append(this.subMenu.el)}function r(e,s,i,o){if(!e||!s)throw"Error in SMLinkItem: invalid title or url param";n.call(this,e),this._label.replaceWith(t("<a/>",{href:s,target:i}).addClass("sm-item-label").addClass(o).append(this._label.contents())),this.$el.addClass("sm-item-link")}function h(t,e,s,i){var o=this;n.call(this,t,s),this.id=i||null,this.$el.addClass("sm-item-button"),this.$el.on(f,function(t){"function"==typeof callback&&callback.call(o,this)})}function a(e,s){i.call(this),this.$el.addClass("sm-item-useraccount"),this.$el.append(this.photo=t("<img/>").addClass("sm-useraccount-photo").attr({src:s})),this.$el.append(this.name=t("<div/>").addClass("sm-useraccount-name").text(e))}function l(e,s){i.call(this),this.$el.addClass("sm-item-separator"),this.$el.append(this.name=t("<div/>").addClass("sm-item-separator-name").text(e||""))}Object.create||(Object.create=function(){function t(){}return function(e){return t.prototype=e,new t}}());var c=!!("ontouchstart"in window||navigator.maxTouchPoints),u=document.createElement("div").style,d=function(){for(var t,e="t,webkitT,MozT,msT,OT".split(","),s=0,i=e.length;s<i;s++)if(t=e[s]+"ransform",t in u)return e[s].substr(0,e[s].length-1);return!1}(),p=function(){if(d===!1)return!1;var t={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"};return t[d]}(),m=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),f=t.event.special.tap?"tap":"click",y="";y+=c?" sm-touch":" sm-desktop",m&&(y+=" sm-mobile"),document.documentElement.className+=y,t.extend(e.prototype,{_add:function(t,e){t._setParent(this),this.items.splice(e,0,t),this.$list.hasChildNodes()&&this.$list.childNodes[e]?this.$list.insertBefore(t.el,this.$list.childNodes.item(e)):this.$list.appendChild(t.el)},_refresh:function(){this.sideMenu&&this.sideMenu._refresh()},_setParent:function(t){this.parentItem=t},_setCurrentMenu:function(t){this.sideMenu.currentMenu=t},_getCurrentMenu:function(){return this.sideMenu.currentMenu},_show:function(t){return this.isOpen=!0,this.$el.css("z-index",2),"function"==typeof t&&this._onTransitionEnd(t),this.$el.addClass("sm-show"),this},_hide:function(t){return this.isOpen&&this.$el.css("z-index",1),this.isOpen=!1,this._onTransitionEnd(function(){this.$el.css("z-index",""),"function"==typeof t&&t.apply(this,arguments)}),this.$el.removeClass("sm-show"),this},_onTransitionEnd:function(t){var e=this;this.$el.one(p,function(s){"function"==typeof t&&t.call(e,this,s)})},_hideSubMenus:function(){if(this.items&&this.items.length)for(var t in this.items)this.items[t]instanceof o&&this.items[t].subMenu._closeWithChilds()},_closeWithChilds:function(){this._hide(),this._hideSubMenus()},_closeWithParents:function(t){t!==this&&this._hide(),this.parentItem&&this.parentItem.parent&&this.parentItem.parent._closeWithParents(t)},_openParents:function(){this.sideMenu.history.clear();var t=[];!function(e){e&&e.parent&&(t.push(e.parent),arguments.callee(e.parent.parentItem))}(this.parentItem),t.reverse();for(var e in t)this.sideMenu.history.add(t[e])},addItem:function(t,e){return this._add(t,void 0===e?this.items.length:e),this._refresh(),this},addItems:function(t,e){if(t){e=void 0===e?this.items.length:e;for(var s=0;s<t.length;s+=1)this._add(t[s],e+s);return this._refresh(),this}},open:function(){if(this.isOpen)return this;var t=this._getCurrentMenu();return t&&t._hide(),this._show(function(){t&&t._closeWithParents(this)}),this._openParents(),this._setCurrentMenu(this),this.sideMenu.history.add(this),this.options.onOpen&&this.options.onOpen.call(this),this},close:function(){return this.isOpen?(this._getCurrentMenu()===this?this.sideMenu.goBack():this._hide(),this.sideMenu.history.isEmpty()&&this._setCurrentMenu(null),this.options.onClose&&this.options.onClose.call(this),this):this},clear:function(){return this.$list.innerHTML="",this.items=[],this},getItemByIndex:function(t){return this.items[t]},getItemByName:function(t){var e,s=new RegExp(t,"gi");for(e in this.items)if(this.items[e].title&&s.test(this.items[e].title))return this.items[e];return null},getSubMenuByName:function(t){var e=this.getItemByName(t);return e?e.subMenu:e},destroy:function(){this.clear(),this.$el.remove(),this.parentItem&&this.parentItem.items.splice(this.parentItem.items.indexOf(this),1)}}),s.prototype=Object.create(e.prototype),t.extend(s.prototype,{constructor:s,_add:function(t,s){e.prototype._add.call(this,t,s),function(t){if(t){t.sideMenu=this;for(var e in t.items)t.items[e]instanceof o&&arguments.callee.call(this,t.items[e].subMenu)}}.call(this,t.subMenu)},_refresh:function(){this._target&&this._target.append(this._target.find(".sm-added").removeClass("sm-added"))},goBack:function(){var t=this.history.beforeLastStak(),e=this.history.pop();this._setCurrentMenu(t||this),e&&e._hide(),t&&t._show()},close:function(){this.history.clear(),this._closeWithChilds(),this._setCurrentMenu(null),this.options.onClose&&this.options.onClose.call(this)},toggle:function(){this.history.isEmpty()?this.open():this.close()},appendTo:function(e){return this._target=t(e).append(this.$el),this._refresh(),this}});var b=function(s,i){var n=this;e.call(this,s,t.extend({},b.options,i)),this.options.back&&(this._back=t("<li/>").addClass("sm-back").on(f,function(t){t.preventDefault(),n.sideMenu.goBack()}).text(this.options.back)),this._back&&this.$content.prepend(this._back),this.$el.addClass("sm-submenu"),this.sideMenu=null};b.options={back:"back"},b.prototype=Object.create(e.prototype),b.prototype.constructor=b,t.extend(i.prototype,{_setParent:function(t){this.parent=t},moveToMenu:function(t,s){var i,n,o=this.parent.items;t instanceof e&&(i=o.indexOf(this),i!==-1&&(n=o[i],o.splice(i,1),t.addItem(n,s)))},moveToPosition:function(t){this.parent&&this.moveToMenu(this.parent,t)},remove:function(){if(this.parent){var t,e=this.parent.items;this.$el.remove(),(t=e.indexOf(this))!==-1&&e.splice(t,1)}}}),n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n.prototype.setTitle=function(t){this.dom.title.text(t)},o.prototype=Object.create(n.prototype),o.prototype.constructor=o,r.prototype=Object.create(n.prototype),r.prototype.constructor=r,h.prototype=Object.create(n.prototype),h.prototype.constructor=h,a.prototype=Object.create(i.prototype),a.prototype.constructor=a,l.prototype=Object.create(i.prototype),l.prototype.constructor=l;var _={SideMenu:s,SideSubMenu:b,SMItem:i,SMLabelItem:n,SMSubMenuItem:o,SMButtonItem:h,SMLinkItem:r,SMUserAccountItem:a,SMSeparatorItem:l,pressEvent:f};return _});