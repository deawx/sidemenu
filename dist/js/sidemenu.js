!function(t,e){if("function"==typeof define&&define.amd)define(["jquery"],function(i){var s=e(i);return i.extend(t,s),s});else if("object"==typeof module&&module.exports){var i=require("jquery"),s=e(i);i.extend(t,s),module.exports=s}else t.jQuery.extend(t,e(t.jQuery))}(this,function(t){Object.create||(Object.create=function(){function t(){}return function(e){return t.prototype=e,new t}}());var e=("ontouchstart"in document.documentElement,document.createElement("div").style),i=function(){for(var t,i="t,webkitT,MozT,msT,OT".split(","),s=0,n=i.length;s<n;s++)if(t=i[s]+"ransform",t in e)return i[s].substr(0,i[s].length-1);return!1}(),s=function(){if(i===!1)return!1;var t={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"};return t[i]}(),n=t.event.special.tapclick?"tapclick":"click",o=function(e,i){this.options={},t.extend(this.options,i),this.$el=t("<div/>").addClass("sm sm-added"),this.el=this.$el.get(0),this.options.title&&this.$el.append(t("<div/>").addClass("sm-title").text(this.title=this.options.title)),this.$list=t("<div/>").appendTo(this.$el).get(0),this.items=[],this.addItems(e),this.isOpen=!1,this.parentItem=null};t.extend(o.prototype,{_add:function(t,e){t._setParent(this),this.items.splice(e,0,t),this.$list.hasChildNodes()&&this.$list.childNodes[e]?this.$list.insertBefore(t.el,this.$list.childNodes.item(e)):this.$list.appendChild(t.el)},_refresh:function(){this.sideMenu&&this.sideMenu._refresh()},_setParent:function(t){this.parentItem=t},_setCurrentMenu:function(t){this.sideMenu.currentMenu=t},_getCurrentMenu:function(){return this.sideMenu.currentMenu},_show:function(t){return this.isOpen=!0,this.$el.css("z-index",2),"function"==typeof t&&this._onTransitionEnd(t),this.$el.addClass("sm-show"),this},_hide:function(t){return this.isOpen&&this.$el.css("z-index",1),this.isOpen=!1,this._onTransitionEnd(function(){this.$el.css("z-index",""),"function"==typeof t&&t.apply(this,arguments)}),this.$el.removeClass("sm-show"),this},_onTransitionEnd:function(t){var e=this;this.$el.one(s,function(i){"function"==typeof t&&t.call(e,this,i)})},_hideSubMenus:function(){if(this.items&&this.items.length)for(var t in this.items)this.items[t]instanceof l&&this.items[t].subMenu._closeWithChilds()},_closeWithChilds:function(){this._hide(),this._hideSubMenus()},_closeWithParents:function(t){t!==this&&this._hide(),this.parentItem&&this.parentItem.parent&&this.parentItem.parent._closeWithParents(t)},_openParents:function(){this.sideMenu.history.clear();var t=(this.el.parentNode,[]);!function(e){e&&e.parent&&(t.push(e.parent),arguments.callee(e.parent.parentItem))}(this.parentItem),t.reverse();for(var e in t)this.sideMenu.history.add(t[e])},addItem:function(t,e){return this._add(t,void 0===e?this.items.length:e),this._refresh(),this},addItems:function(t,e){if(t){e=void 0===e?this.items.length:e;for(var i=0;i<t.length;i+=1)this._add(t[i],e+i);return this._refresh(),this}},open:function(){if(this.isOpen)return this;var t=this._getCurrentMenu();return t&&t._hide(),this._show(function(){t&&t._closeWithParents(this)}),this._openParents(),this._setCurrentMenu(this),this.sideMenu.history.add(this),this.options.onOpen&&this.options.onOpen.call(this),this},close:function(){return this.isOpen?(this._getCurrentMenu()===this?this.sideMenu.goBack():this._hide(),this.sideMenu.history.isEmpty()&&this._setCurrentMenu(null),this.options.onClose&&this.options.onClose.call(this),this):this},clear:function(){return this.$list.innerHTML="",this.items=[],this},getItemByIndex:function(t){return this.items[t]},getItemByName:function(t){var e,i=new RegExp(t,"gi");for(e in this.items)if(this.items[e].title&&i.test(this.items[e].title))return this.items[e];return null},getSubMenuByName:function(t){var e=this.getItemByName(t);return e?e.subMenu:e},destroy:function(){this.clear(),this.$el.remove(),this.parentItem&&this.parentItem.items.splice(this.parentItem.items.indexOf(this),1)}});var r=function(t,e){e=e||{},e.back="",o.call(this,t,e),this.history={stacks:[],clear:function(){this.stacks=[]},add:function(t){t&&this.stacks.push(t)},pop:function(){return this.stacks.pop()},beforeLastStak:function(){return this.stacks[this.stacks.length-2]},isEmpty:function(){return 0===this.stacks.length}},this._target=null,this.sideMenu=this,this.currentMenu=null};r.prototype=Object.create(o.prototype),t.extend(r.prototype,{constructor:r,_add:function(t,e){o.prototype._add.call(this,t,e),function(t){if(t){t.sideMenu=this;for(var e in t.items)t.items[e]instanceof l&&arguments.callee.call(this,t.items[e].subMenu)}}.call(this,t.subMenu)},_refresh:function(){this._target&&this._target.append(this._target.find(".sm-added").removeClass("sm-added"))},goBack:function(){var t=this.history.beforeLastStak(),e=this.history.pop();this._setCurrentMenu(t||this),e&&e._hide(),t&&t._show()},close:function(){this.history.clear(),this._closeWithChilds(),this._setCurrentMenu(null),this.options.onClose&&this.options.onClose.call(this)},toggle:function(){this.history.isEmpty()?this.open():this.close()},appendTo:function(e){return this._target=t(e).append(this.$el),this._refresh(),this}});var a=function(e,i){var s=this;o.call(this,e,t.extend({},a.options,i)),this.options.back&&(this._back=t("<div/>").addClass("sm-back").on(n,function(t){t.originalEvent&&t.preventDefault(),t.preventDefault(),s.sideMenu.goBack()}).text(this.options.back)),this._back.insertBefore(this.el.lastChild),this.$el.addClass("sm-submenu"),this.sideMenu=null};a.options={back:"back"},a.prototype=Object.create(o.prototype),a.prototype.constructor=a;var h=function(){this.$el=t("<div/>").addClass("sm-item"),this.el=this.$el.get(0),this.parent=null};t.extend(h.prototype,{_setParent:function(t){this.parent=t},moveToMenu:function(t,e){var i,s,n=this.parent.items;t instanceof o&&(i=n.indexOf(this),i!==-1&&(s=n[i],n.splice(i,1),t.addItem(s,e)))},moveToPosition:function(t){this.parent&&this.moveToMenu(this.parent,t)},remove:function(){if(this.parent){var t,e=this.parent.items;this.$el.remove(),(t=e.indexOf(this))!==-1&&e.splice(t,1)}}});var c=function(e,i){if(void 0===e)throw"Error in SMLabelItem: title param is undefined";h.call(this),this.title=e,this.dom=this.dom||{},this.dom.title=t("<span/>").addClass("sm-label-text").text(this.title),this.$el.append(this._label=t("<div/>").addClass("sm-item-label").addClass(i).append(t("<span/>").addClass("sm-label-icon")).append(this.dom.title))};c.prototype=Object.create(h.prototype),c.prototype.constructor=c,c.prototype.setTitle=function(t){this.dom.title.text(t)};var l=function(t,e,i){var s=this;c.call(this,t,i),this.$el.addClass("sm-item-more"),this._label.on(n,function(t){t.stopPropagation(),s.subMenu.open()}),this.subMenu=new a(e,{title:t}),this.subMenu._setParent(this),this.$el.append(this.subMenu.el)};l.prototype=Object.create(c.prototype),l.prototype.constructor=l;var u=function(e,i,s,n){if(!e||!i)throw"Error in SMLinkItem: invalid title or url param";c.call(this,e),this._label.replaceWith(t("<a/>",{href:i,target:s}).addClass("sm-item-label").addClass(n).append(this._label.contents())),this.$el.addClass("sm-item-link")};u.prototype=Object.create(c.prototype),u.prototype.constructor=u;var p=function(t,e,i,s){var o=this;c.call(this,t,i),this.id=s||null,this.$el.addClass("sm-item-button"),this.$el.on(n,function(t){"function"==typeof e&&e.call(o,this)})};p.prototype=Object.create(c.prototype),p.prototype.constructor=p;var d=function(e,i){h.call(this),this.$el.addClass("sm-item-useraccount"),this.$el.append(this.photo=t("<img/>").addClass("sm-useraccount-photo").attr({src:i})),this.$el.append(this.name=t("<div/>").addClass("sm-useraccount-name").text(e))};d.prototype=Object.create(h.prototype),d.prototype.constructor=d;var f=function(e,i){h.call(this),this.$el.addClass("sm-item-separator"),this.$el.append(this.name=t("<div/>").addClass("sm-item-separator-name").text(e||""))};f.prototype=Object.create(h.prototype),f.prototype.constructor=f;var m={SideMenu:r,SideSubMenu:a,SMItem:h,SMLabelItem:c,SMSubMenuItem:l,SMButtonItem:p,SMLinkItem:u,SMUserAccountItem:d,SMSeparatorItem:f,pressEvent:n};return m}),function(t){var e="ontouchstart"in window;t.event.special.tapclick=e?{distanceThreshold:10,timeThreshold:500,_fn:function(e){function i(){clearTimeout(o),a.off("touchmove",n).off("touchend",s),"button"==a.attr("role")&&a.removeClass("tapped")}function s(e){i();var s=e.originalEvent.touches;s&&s.length>1||h==e.target&&t.event.simulate("tapclick",r,e)}function n(t){var e=t.originalEvent.touches[0],s=e.pageX,n=e.pageY;(Math.abs(s-l)>p||Math.abs(n-u)>p)&&i()}var o,r=this,a=t(this),h=e.target,c=e.originalEvent.touches[0],l=c.pageX,u=c.pageY,p=t.event.special.tapclick.distanceThreshold;e.originalEvent.touches.length>1||(o=setTimeout(i,t.event.special.tapclick.timeThreshold),a.on("touchmove",n).on("touchend",s),"button"==a.attr("role")&&a.addClass("tapped"))},_default:function(t){t.preventDefault()},setup:function(){var e=this;"A"==e.nodeName&&(e.onclick=t.event.special.tapclick._default),t(e).on("touchstart",t.event.special.tapclick._fn)},remove:function(){var e=this;"A"==e.nodeName&&e.onclick===t.event.special.tapclick._default&&(e.onclick=null),t(e).off("touchstart",t.event.special.tapclick._fn)}}:{setup:function(){t(this).on("click",t.event.special.tapclick.click)},click:function(e){e.type="tapclick",t.event.dispatch.apply(this,arguments)},teardown:function(){t(this).off("click",t.event.special.tapclick.click)}}}(jQuery);